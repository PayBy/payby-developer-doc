---
title: Order Creation
toc_max_heading_level: 6
---

import Paypage from "./_paypage.md";
import E_WALLET from "./_e-wallet.md";
import AutoDebit from "./_auto-debit.md";
import DirectPay from "./_direct-pay.md";
import DYNQR from "./_dynqr.md";
import JSAPI from "./_jsapi.md";
import QRPAY from "./_qrpay.md";
import InAPP from "./_in-app.md";
import BizContent from "./_biz_content.mdx";
import AcquireOrder from "./_acquire-order.mdx";
import { useState } from "react";

export const PRODUCTS_ENUM = {
  PAYPAGE: "Paypage",
  IN_APP_SDK: "In-APP SDK",
  E_WALLET: "E-wallet",
  DYNQR: "DYNQR",
  QRPAY: "QRPAY",
  JSAPI: "JSAPI",
  AUTODEBIT: "AUTODEBIT",
  DIRECTPAY: "DIRECTPAY",
};

export const PRODUCTS_MAP = {
  [PRODUCTS_ENUM.PAYPAGE]: Paypage,
  [PRODUCTS_ENUM.E_WALLET]: E_WALLET,
  [PRODUCTS_ENUM.DYNQR]: DYNQR,
  [PRODUCTS_ENUM.QRPAY]: QRPAY,
  [PRODUCTS_ENUM.JSAPI]: JSAPI,
  [PRODUCTS_ENUM.AUTODEBIT]: AutoDebit,
  [PRODUCTS_ENUM.DIRECTPAY]: DirectPay,
  [PRODUCTS_ENUM.IN_APP_SDK]: InAPP,
};

export function SwitchProduct() {
  const [product, setProduct] = useState(PRODUCTS_ENUM.PAYPAGE);
  const ProductComponent = PRODUCTS_MAP[product];
  return (
    <div>
      <label htmlFor="product" className="">
        Products:
      </label>
      &nbsp;
      <select name="product" id="product" value={product} onChange={(e) => setProduct(e.target.value)}>
        {Object.values(PRODUCTS_ENUM).map((s) => (
          <option key={s} value={s}>
            {s}
          </option>
        ))}
      </select>
      <br />
      <br />
      <li>
        <b>paySceneParams</b> <span style={{ color: " #7d8793" }}>String</span>
      </li>
      <br />
      <details>
        <summary>
          Different payment scenarios need to pass different scenario parameters. For details, please visit
        </summary>
        <ProductComponent />
      </details>
    </div>
  );
}

## Create order

Creates an order.

### Interface URL

Staging : https://uat.test2pay.com/sgs/api/acquire2/placeOrder

Production : https://api.payby.com/sgs/api/acquire2/placeOrder

### Request

#### Http Header

---

**Content-Language** <span style={{color:"#7d8793"}}>String</span>

The language in which the response message will be used, currently only English is supported.

Example value: en

Maximum length: `10`

<br />

**Content-Type** <span style={{color:"#7d8793"}}>String</span> <span style={{color:"#f19938"}}>Required</span>

The media type. Required for operations with a request body. The value is `application/<format>`, where `format` is `json`.

Example value: application/json

<br />

**sign** <span style={{color:" #7d8793"}}>String</span> <span style={{color:"#f19938"}}>Required</span>

Requests should be signed using private-key cryptography. This allows the payment gateway to verify that an incoming request is really from your application.

<br />

**Partner-Id** <span style={{color:" #7d8793"}}>String</span> <span style={{color:"#f19938"}}>Required</span>

The merchant id of your account.

Example value: 200001200101

Maximum length: `12`

<br />

#### Http Body

---

**requestTime** <span style={{color:" #7d8793"}}>Timestamp</span> <span style={{color:"#f19938"}}>Required</span>

Request time of the order. If the request time is more than 15 minutes away from the current time, the request will be rejected. This parameter is used to prevent repeated requests for orders that should have been cancelled due to timeouts.

Example value: 1581493898000

<br />

**bizContent** <span style={{color:" #7d8793"}}>Object</span>

<details>
  <summary> The attributes are: </summary>
  <BizContent />
</details>

#### Request sample

```json
Http Header
{
    "Content-Language": "en",
    "Content-Type": "application/json",
    "sign": "IXJI/QicPQotIsIDBcSGIg6jtJUXs1rTuifQFZUNd3KDTl25GKmpYO7OrkaKkTV0shDRitLmkxJCe3Z60zHE2ZSeVczrhwrnmuMG+bX9N22Hw821H6MydsXetYHRnyf5dPbgpmVja582w49grA6jRlVFAVMYdxKJDPSCb2X/IpltvyrLQ1Wt+lqr+fnpYXvyON6/PIZIQIknC8BVddVahxJnaC6HEagvJf6gskz22/DFfPHT1mlMA9pg8qrbh4O7DYZahf8TB3nIzAPc/FHOUZkYYTT2c8m4eLL8740nJVK7D3IOSqSnBAU/iJ2omjPPFvRCCSqzz17pkGsT7AW91w==",
    "Partner-Id": "200000000888"
}

Http Body
{
    "requestTime": 1581404947666,
    "bizContent": {
        "merchantOrderNo": "M965739182419",
        "subject": "Your subject",
        "totalAmount": {
            "currency": "AED",
            "amount": 1.01
        },
        "paySceneCode": "PAYPAGE",
        "paySceneParams": {
            "redirectUrl": "http://www.yoursite.com?orderId=123"
        },
        "reserved": "order desc",
        "notifyUrl": "http://www.yoursite.com",
        "accessoryContent": {
            "amountDetail": {
                "vatAmount": {
                    "currency": "AED",
                    "amount": 20.65
                },
                "amount": {
                    "currency": "AED",
                    "amount": 1.09
                }
            },
            "goodsDetail": {
                "body": "Gifts",
                "categoriesTree": "CT12",
                "goodsCategory": "GC10",
                "goodsId": "GI1005",
                "goodsName": "candy flower",
                "price": {
                    "currency": "AED",
                    "amount": 10.87
                },
                "quantity": 2
            },
            "terminalDetail": {
                "operatorId": "OP1000000000000001",
                "storeId": "SI100000000000002",
                "terminalId": "TI100999999999900",
                "merchantName": "candy home",
                "storeName": "lovely house"
            }
        }
    }
}

```

<br />

### Response

#### Http Header

---

**sign** <span style={{color:" #7d8793"}}>String</span> <span style={{color:"#f19938"}}>Required</span>

When Payby sends response, Payby will use its own private key to sign the message, and the merchant uses Payby 's public key to verify the signature. If the verification is passed, it proves that the response was sent by Payby and not faked by others.

<br />

#### Http Body

---

**head**

- **applyStatus** <span style={{color:" #7d8793"}}>Enum</span> <span style={{color:"#f19938"}}>Required</span>

  The result of the request. The possible values are:

  `SUCCESS `- Application successful.
  `FAIL` - Application failed. Check the `code` and `msg` for exact reason.
  `ERROR` - Application error. The signature verification failed. Please check whether the private key used for the signature and the public key uploaded on the PayBy portal are one key pair.

<br />

- **code** <span style={{color:" #7d8793"}}>String</span> <span style={{color:"#f19938"}}>Required</span>

  Response Codes. View the [resconse codes](#response code) section to know all the possible results.

  Example value: 0

  <br />

- **msg** <span style={{color:" #7d8793"}}>String</span>

  Description of this code. View the [resconse codes](#response code) section to know all the possible results.

  <br />

- **traceCode** <span style={{color:" #7d8793"}}>String</span>

  No special meaning, PayBy internally used to locate the error.

  <br />

**body**

**Notice **:Body is returned only when `applystatus` = `success`, and `code` = `0`. If `applystatus` = `error` or `failed`; or `applystatus` = `success`, `code` !=`0` , that indicates an error. Please check errors and try again.

- **acquireOrder** <span style={{color:" #7d8793"}}>Object</span>

  <details>
  <summary>The attributes are:</summary>
    <AcquireOrder />
  </details>

- **interactionParams**

  In different payment scenarios, PayBy may return different parameters, allowing the merchant system and PayBy continue to interact to complete the order.

  - **tokenUrl** <span style={{color:" #7d8793"}}>String</span>

    Appears only in the following payment scene.

    `PAYPAGE`. A link that redirects the payer to the paypage.

    `INAPP`. A link that redirects the payer to the paypage or the chosen E-wallet.

    `DYNQR`. A link that redirects the payer to the paypage.

    `JSAPI`. A link that redirects the payer to the checkout within the APP.

    <br />

  - **deepLink** <span style={{color:" #7d8793"}}>String</span>

    Appears only in `EWALLET` payment scene.

    When the payer chooses to open another e-wallet for payment at the merchant's payment page, PayBy will return a link to redirect the payer to the e-wallet's checkout.

    <br />

  - **threeDSecureDom** <span style={{color:" #7d8793"}}>String</span>

    Appears only in `DIRECTPAY` payment scene.

    If the merchant decides or PayBy's risk control system recognizes that the transaction requires 3DS verification, the 3DS verification link will be returned.

    <br />

  > The `AUTODEBIT` and `QRPAY `payment scene don't have `interactionParams`.

<br />

#### Response sample

```json
Http Header
{
    "sign": "JzWjVQ245trg3p0CyuwUUHN+Ck40q/HDaMvhqueHDP8YHqC/Uw3c9VWCw4gKsNbk+CRShjT+bvKkck8Fc3aAiRK8wIVQz6eu95sPkJgZp5A0P+tfMH/44F+3CrejtbEIkrHdSwhy98Tv9TYs9QFe7Yni/vEJ8P4OU6FZJOi8LGOMF6Nc8+S5qftc7qLA17cNJ7NJYC+EW8suGe/NmGA9c5NMK5BwHTHzXYOjXwXLx8mw4M3hiirl0wtVym3hrOmbkujYZCH56h8uOVF0FbHGu5uoq61NuniJitLLs9qyiEprQzUe8oWsJnHKXeGAgEr//fLXIXgYsRYb7AWoJzs6Eg=="
}

Http Body
{
    "head": {
        "applyStatus": "SUCCESS",
        "code": "0",
        "msg": "SUCCESS",
        "traceCode": "1127"
    },
    "body": {
        "acquireOrder": {
            "merchantOrderNo": "M965739182419",
            "orderNo": "131404956265007836",
            "status": "CREATED",
            "product": "Basic Payment Gateway",
            "totalAmount": {
                "currency": "AED",
                "amount": 1.01
            },
            "payeeMid": "200000000888",
            "expiredTime": 1581412155966,
            "notifyUrl": "http://www.yoursite.com",
            "subject": "Your subject",
            "requestTime": 1581404955966,
            "accessoryContent": {
                "amountDetail": {
                    "vatAmount": {
                        "currency": "AED",
                        "amount": 20.65
                    },
                    "amount": {
                        "currency": "AED",
                        "amount": 1.09
                    }
                },
                "goodsDetail": {
                    "body": "Gifts",
                    "categoriesTree": "CT12",
                    "goodsCategory": "GC10",
                    "goodsId": "GI1005",
                    "goodsName": "candy flower",
                    "price": {
                        "currency": "AED",
                        "amount": 10.87
                    },
                    "quantity": 2
                },
                "terminalDetail": {
                    "operatorId": "OP1000000000000001",
                    "storeId": "SI100000000000002",
                    "terminalId": "TI100999999999900",
                    "merchantName": "candy home",
                    "storeName": "lovely house"
                }
            },
            "paySceneCode": "PAYPAGE",
            "interActionParams": {
                "tokenUrl": "https://paypage.payby.com?BIZ_TYPE=202&ft=dd89cd1b-627c-475c-b60c-8ae3a8faa4d8&t=1581404956715"
            }
        }
    }
}
```

<br />

#### Response Codes <span id="response code"> </span>

| Code  | Msg                               | Reason                                                                             | Solution                               |
| ----- | --------------------------------- | ---------------------------------------------------------------------------------- | -------------------------------------- |
| 0     | SUCCESS                           | Successful                                                                         |                                        |
| 400   | INVALID_PARAMETER                 | Parameter error                                                                    | Adjust the request parameters          |
| 400   | REQUESTTIME_TOO_EARLY             | Request time is much earlier than current time                                     | Adjust request time                    |
| 400   | REQUESTTIME_TOO_LATER             | Request time is much later than current time                                       | Adjust request time                    |
| 402   | RATE_LIMIT_REJECT                 | Requests are too frequent                                                          | Reduce request frequency               |
| 403   | UNAUTHORIZED                      | API is not authorized                                                              | Contact PayBy                          |
| 404   | SERVICE_NOT_AVAILABLE             | API service is unavailable                                                         | Contact PayBy                          |
| 500   | SYSTEM_ERROR                      | System error                                                                       | Contact PayBy and try again later      |
| 504   | SERVICE_TIMEOUT                   | Service timeout                                                                    | Try again later                        |
| 601   | RISK_FAIL                         | Risk control verification failed                                                   | Please adjust the business             |
| 62001 | ORDER_PAID                        | Successfully paid orders cannot be cancelled                                       | Adjust the merchant order number       |
| 62002 | ORDER_FAILURE                     | Failed orders cannot be cancelled or refunded                                      | Adjust the merchant order number       |
| 62003 | ORDER_SETTLED                     | Settled order cannot be cancelled                                                  | Adjust the merchant order number       |
| 62008 | EXPIREDTIME_LESS_THAN_REQUESTTIME | The expiration time is earlier than the request time                               | Adjust the expiration time             |
| 62009 | EXPIREDTIME_TOO_LATER             | The expiration time is exceeded more than 48 hours from the requested time         | Adjust the expiration time             |
| 62012 | PAYSCENECODE_ILLEGAL              | Invalid payment scenario code                                                      | Adjust the payment scenario code       |
| 62016 | MERCHANT_ORDER_NO_EXIST           | Merchant order exists                                                              | Adjust mechant request number          |
| 62019 | PAYEEMID_NOT_EXIST                | Invalid PayeeMid                                                                   | Adjust payeeMid                        |
| 62026 | PRODUCT_IS_NOT_APPLIED            | Product not applied                                                                | Apply for product first                |
| 62036 | MERCHANT_DEVICE_NOT_EXIST         | Merchant device does not exist                                                     | Adjust secondaryMerchantId or deviceId |
| 62037 | DEVICE_ACCESS_FORBIDDEN           | Device access forbidden                                                            | Adjust device status                   |
| 62038 | INVALID_SECONDARY_MERCHANT        | The secondary merchant that initiated the refund does not match the original order | Adjust secondarymerchantId             |
| 62073 | INVALID_ONE_TIME_PAYMENT          | Invalid oneTimePayment                                                             | Adjust request parameters              |
