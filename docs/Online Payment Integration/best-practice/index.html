<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Online Payment Integration/best-practice">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.22">
<link rel="alternate" type="application/rss+xml" href="/payby-developer-doc/blog/rss.xml" title="Integrate PayBy and Accept Payment RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/payby-developer-doc/blog/atom.xml" title="Integrate PayBy and Accept Payment Atom Feed"><title data-rh="true">Best practice | Integrate PayBy and Accept Payment</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kunlongxu.github.io/payby-developer-doc/docs/Online Payment Integration/best-practice"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Best practice | Integrate PayBy and Accept Payment"><meta data-rh="true" name="description" content="Merchant and PayBy system interaction"><meta data-rh="true" property="og:description" content="Merchant and PayBy system interaction"><link data-rh="true" rel="icon" href="/payby-developer-doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kunlongxu.github.io/payby-developer-doc/docs/Online Payment Integration/best-practice"><link data-rh="true" rel="alternate" href="https://kunlongxu.github.io/payby-developer-doc/docs/Online Payment Integration/best-practice" hreflang="en"><link data-rh="true" rel="alternate" href="https://kunlongxu.github.io/payby-developer-doc/docs/Online Payment Integration/best-practice" hreflang="x-default"><link rel="stylesheet" href="/payby-developer-doc/assets/css/styles.2554a396.css">
<link rel="preload" href="/payby-developer-doc/assets/js/runtime~main.3185ed05.js" as="script">
<link rel="preload" href="/payby-developer-doc/assets/js/main.4c5bf2f5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/payby-developer-doc/"><div class="navbar__logo"><img src="/payby-developer-doc/img/logo.svg" alt="PayBy Developer Website" class="themedImage_ToTc themedImage--light_HNdA"><img src="/payby-developer-doc/img/logo.svg" alt="PayBy Developer Website" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Developer</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/payby-developer-doc/docs/createorder">APIs</a><a class="navbar__item navbar__link" href="/payby-developer-doc/demos/overview">Demos</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/General/integration-guide">General</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/payby-developer-doc/docs/Online Payment Integration/overview">Online Payment Integration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/payby-developer-doc/docs/Online Payment Integration/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/payby-developer-doc/docs/Online Payment Integration/Checkout/hosted-paypage">Checkout</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/payby-developer-doc/docs/Online Payment Integration/Special Payment Scenes/ewallet">Special Payment Scenes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/payby-developer-doc/docs/Online Payment Integration/Plugins/magento/">Plugin</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/payby-developer-doc/docs/Online Payment Integration/best-practice">Best practice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/payby-developer-doc/docs/Online Payment Integration/test-case">Test case</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/createorder">Payment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/refund">Refund</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/Transfer to bank/list-countries-and-currencies">Transfer to bank</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/Transfer/">Transfer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/Reconciliation/statement-download">Reconciliation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/Crypto Pay/order-creation">Crypto Pay</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/Crypto Top Up/deposit-address-query">Crypto Top Up</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/Digital Receipt/digital-receipts-creation">Digital Receipt</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/payby-developer-doc/docs/SDKs/inapp">SDKs</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/payby-developer-doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Online Payment Integration</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Best practice</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Best practice</h1><br><h3 class="anchor anchorWithStickyNavbar_LWe7" id="merchant-and-payby-system-interaction">Merchant and PayBy system interaction<a class="hash-link" href="#merchant-and-payby-system-interaction" title="Direct link to heading">​</a></h3><ol><li>The merchant’s server calls the order creation interface to request an order.</li><li>The merchant’s server queries the order status.</li><li>The merchant’s server receives payment notifications.</li></ol><br><h3 class="anchor anchorWithStickyNavbar_LWe7" id="recommended-payment-flow">Recommended payment flow<a class="hash-link" href="#recommended-payment-flow" title="Direct link to heading">​</a></h3><p>Before any payments can be processed, an order needs to be initiated by the merchant along with the merchant order number using Order creation API.</p><p>The merchant order number is generated by the merchant. It only supports the combination of letters, numbers, dashes (-) and underscores (_). PayBy requires the merchant order number to be unique for the same merchant (it is recommended to generate the order number according to the current system time plus a random sequence).</p><p>When an order is created, PayBy finishes the payment processing asynchronously and doesn&#x27;t require the requester to hold on to a connection to wait. This gives more flexibility and for PayBy to serve more requests simultaneously, however, the requester doesn&#x27;t immediately know the result of their payment as a side effect. To notify the merchant of the processing result, PayBy sends a notification to the merchant when payment has been processed or accepts a periodic query from the merchants to find out the latest state of the order. We will explain more in detail in the below sections.</p><br><h3 class="anchor anchorWithStickyNavbar_LWe7" id="re-initiate-a-payment">Re-initiate a payment<a class="hash-link" href="#re-initiate-a-payment" title="Direct link to heading">​</a></h3><p>To re-initiate a payment, the original merchant order number should be used to avoid repeated payment. On the other hand, an order that has been paid or canceled cannot be re-opened. This is especially useful to offer clear traceability when it comes to audits or disputes.</p><br><h3 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-retrieve-an-order">When to retrieve an order?<a class="hash-link" href="#when-to-retrieve-an-order" title="Direct link to heading">​</a></h3><p>The query endpoint allows merchants to inquire about the status and details of all orders (pay, refund, transfer). Merchants can query the order status proactively and periodically using this API to determine the next step.</p><p>Even though PayBy tries everything possible to deliver a result notification, there are still cases where querying the order status is necessary and better, especially, in the following cases:</p><ol><li>The Merchant&#x27;s server experiences regular maintenance and temporary outages of sorts so that a notification cannot be delivered.</li><li>A system error or unknown transaction status is returned when calling the payment APIs.</li><li>To confirm payment status before calling the <code>Order creation API</code>.</li></ol><br><h3 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-cancel-revoke-an-order">When to cancel (revoke) an order<a class="hash-link" href="#when-to-cancel-revoke-an-order" title="Direct link to heading">​</a></h3><p>It is inevitable that some payments may fail or need to be re-initiated. As mentioned above, to keep the payment history clean and avoid duplicate payments, it&#x27;s important for Merchants to follow the best practice and cancel an unfulfilled order when:</p><ol><li>During order creation, the request times out or didn&#x27;t process successfully within an acceptable time window. It&#x27;s always a good practice to query for the order status and cancel when it times out.</li><li>Before re-initiate a new order before or after the above-mentioned timeout, it&#x27;s recommended to cancel the previous one even though it may not have come through.</li><li>After an order is created and pending payment from the user, the user might fail to proceed with the payment, e.g. accidentally declining, this would also require the merchant to cancel the order and create a new one.</li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/payby-developer-doc/docs/Online Payment Integration/Plugins/woocommerce/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">WooCommerce plugin</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/payby-developer-doc/docs/Online Payment Integration/test-case"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Test case</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#merchant-and-payby-system-interaction" class="table-of-contents__link toc-highlight">Merchant and PayBy system interaction</a></li><li><a href="#recommended-payment-flow" class="table-of-contents__link toc-highlight">Recommended payment flow</a></li><li><a href="#re-initiate-a-payment" class="table-of-contents__link toc-highlight">Re-initiate a payment</a></li><li><a href="#when-to-retrieve-an-order" class="table-of-contents__link toc-highlight">When to retrieve an order?</a></li><li><a href="#when-to-cancel-revoke-an-order" class="table-of-contents__link toc-highlight">When to cancel (revoke) an order</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 PayBy, Inc. All Rights Reserved.</div></div></div></footer></div>
<script src="/payby-developer-doc/assets/js/runtime~main.3185ed05.js"></script>
<script src="/payby-developer-doc/assets/js/main.4c5bf2f5.js"></script>
</body>
</html>